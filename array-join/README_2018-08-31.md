## Benchmark: `bench.js`

```js
'use strict';
const ITERATIONS = 1000;
// const ITERATIONS = 5;
const WITH_WARMUP = arguments[0] == 'with-warmup';
const SETUP_VARIANT_NAME = arguments[1];
const VARIANT_NAME = arguments[2];
const ARRAY_SIZE = +arguments[3];

class Obj {
  constructor(str) { this.str = str; }
  toString() { return this.str; }
}

const SETUP_VARIANTS = {
  smi() {
    const array = [];
    for (let i = 0; i < ARRAY_SIZE; ++i) array[i] = i;
    return array;
  },
  string() {
    const array = [];
    for (let i = 0; i < ARRAY_SIZE; ++i) array[i] = `Item no. ${i}`;
    return array;
  },
  double() {
    const array = [];
    for (let i = 0; i < ARRAY_SIZE; ++i) array[i] = i + 0.25;
    return array;
  },
  object() {
    const array = [];
    for (let i = 0; i < ARRAY_SIZE; ++i) array[i] = new Obj(`Item no. ${i}`);
    return array;
  },
  sparseSmi() {
    const array = SETUP_VARIANTS.smi();
    array.length = array.length * 2;
    return array;
  },
  sparseString() {
    const array = SETUP_VARIANTS.string();
    array.length = array.length * 2;
    return array;
  }
};

const VARIANTS = {
  join: array => array.join(),
  joinSep: array => array.join('-')
}

const array = SETUP_VARIANTS[SETUP_VARIANT_NAME]();
const func = VARIANTS[VARIANT_NAME];

let result = 0; // Defeat Escape Analysis
const bench = () => {
  for (let i = 0; i < ITERATIONS; i++) {
    result = func(array);
  }
};

if (WITH_WARMUP) {
  bench();
  bench();
  bench();
}

// const start = /*performance.now()*/Date.now();
const start = performance.now();
bench();
print(performance.now() - start);
// print(/*performance.now()*/ Date.now() - start);

```

## Results

|  Args  | Before | After | Improvement |
|--------|--------|-------|-------------|
| no-warmup smi join 1 | 0.2705ms | 0.1585ms | 1.71x |
| no-warmup smi join 2 | 0.8270ms | 0.1665ms | 4.97x |
| no-warmup smi join 4 | 0.9710ms | 0.1990ms | 4.88x |
| no-warmup smi join 8 | 1.7590ms | 0.2395ms | 7.34x |
| no-warmup smi join 32 | 2.6610ms | 0.5190ms | 5.13x |
| no-warmup smi join 64 | 3.1855ms | 0.9155ms | 3.48x |
| no-warmup smi join 128 | 4.5770ms | 1.8260ms | 2.51x |
| no-warmup smi join 256 | 6.4675ms | 3.2425ms | 1.99x |
| no-warmup smi join 512 | 10.1465ms | 5.9690ms | 1.70x |
| no-warmup smi join 1024 | 17.7670ms | 10.8685ms | 1.63x |
| no-warmup string join 1 | 0.2695ms | 0.1545ms | 1.74x |
| no-warmup string join 2 | 0.8610ms | 0.1700ms | 5.06x |
| no-warmup string join 4 | 0.9840ms | 0.2155ms | 4.57x |
| no-warmup string join 8 | 1.8260ms | 0.2580ms | 7.08x |
| no-warmup string join 32 | 3.0090ms | 0.6000ms | 5.01x |
| no-warmup string join 64 | 3.7770ms | 1.2075ms | 3.13x |
| no-warmup string join 128 | 4.7910ms | 2.0070ms | 2.39x |
| no-warmup string join 256 | 7.0820ms | 3.5500ms | 1.99x |
| no-warmup string join 512 | 10.9890ms | 5.8140ms | 1.89x |
| no-warmup string join 1024 | 20.4125ms | 11.0350ms | 1.85x |
| no-warmup double join 1 | 0.2855ms | 0.1680ms | 1.70x |
| no-warmup double join 2 | 1.2045ms | 0.4450ms | 2.71x |
| no-warmup double join 4 | 1.4400ms | 0.6750ms | 2.13x |
| no-warmup double join 8 | 2.7680ms | 1.0950ms | 2.53x |
| no-warmup double join 32 | 5.9220ms | 3.9555ms | 1.50x |
| no-warmup double join 64 | 9.5750ms | 7.3240ms | 1.31x |
| no-warmup double join 128 | 16.7180ms | 13.8795ms | 1.20x |
| no-warmup double join 256 | 31.2075ms | 27.5295ms | 1.13x |
| no-warmup double join 512 | 58.5225ms | 53.9560ms | 1.08x |
| no-warmup double join 1024 | 118.7565ms | 107.6000ms | 1.10x |
| no-warmup object join 1 | 0.3405ms | 0.4580ms | 0.74x |
| no-warmup object join 2 | 1.0060ms | 0.3575ms | 2.81x |
| no-warmup object join 4 | 1.2530ms | 0.4870ms | 2.57x |
| no-warmup object join 8 | 2.3870ms | 0.8120ms | 2.94x |
| no-warmup object join 32 | 4.8580ms | 2.7470ms | 1.77x |
| no-warmup object join 64 | 7.4135ms | 5.9195ms | 1.25x |
| no-warmup object join 128 | 11.9180ms | 10.6205ms | 1.12x |
| no-warmup object join 256 | 21.0895ms | 19.0885ms | 1.10x |
| no-warmup object join 512 | 39.6265ms | 37.8950ms | 1.05x |
| no-warmup object join 1024 | 79.9170ms | 71.8590ms | 1.11x |
| no-warmup sparseSmi join 1 | 0.8515ms | 0.1705ms | 4.99x |
| no-warmup sparseSmi join 2 | 0.9605ms | 0.1895ms | 5.07x |
| no-warmup sparseSmi join 4 | 1.7630ms | 0.2150ms | 8.20x |
| no-warmup sparseSmi join 8 | 2.2535ms | 0.2830ms | 7.96x |
| no-warmup sparseSmi join 32 | 3.4615ms | 0.6710ms | 5.16x |
| no-warmup sparseSmi join 64 | 4.6510ms | 1.3370ms | 3.48x |
| no-warmup sparseSmi join 128 | 7.7480ms | 2.2690ms | 3.41x |
| no-warmup sparseSmi join 256 | 11.6455ms | 3.8775ms | 3.00x |
| no-warmup sparseSmi join 512 | 25.9800ms | 6.9390ms | 3.74x |
| no-warmup sparseSmi join 1024 | 50.6090ms | 13.0555ms | 3.88x |
| no-warmup sparseString join 1 | 0.8090ms | 0.1635ms | 4.95x |
| no-warmup sparseString join 2 | 0.9265ms | 0.1845ms | 5.02x |
| no-warmup sparseString join 4 | 1.7535ms | 0.2220ms | 7.90x |
| no-warmup sparseString join 8 | 2.2635ms | 0.3005ms | 7.53x |
| no-warmup sparseString join 32 | 3.5775ms | 0.7420ms | 4.82x |
| no-warmup sparseString join 64 | 4.5570ms | 1.4895ms | 3.06x |
| no-warmup sparseString join 128 | 6.2465ms | 2.3535ms | 2.65x |
| no-warmup sparseString join 256 | 9.7475ms | 3.9295ms | 2.48x |
| no-warmup sparseString join 512 | 26.7600ms | 7.0090ms | 3.82x |
| no-warmup sparseString join 1024 | 52.8435ms | 13.5425ms | 3.90x |


![Results](https://image-charts.com/chart?cht=bhg&amp;chs=1024x4096&amp;chds=0,118.75650000000002&amp;chco=c6d9fd,4d89f9&amp;chbh=a&amp;chxs=0,000000,0,0,_&amp;chxt=y,x&amp;chm=N,000000,0,,10|N,000000,1,,10&amp;chma=10,50&amp;chtt=Time%20in%20ms%20(less%20is%20better)%20%5B*%20est%20startup%20perf%5D&amp;chdl=before|after&amp;chxl=0:|1:|no-warmup%20smi%20join%201*|no-warmup%20smi%20join%202*|no-warmup%20smi%20join%204*|no-warmup%20smi%20join%208*|no-warmup%20smi%20join%2032*|no-warmup%20smi%20join%2064*|no-warmup%20smi%20join%20128*|no-warmup%20smi%20join%20256*|no-warmup%20smi%20join%20512*|no-warmup%20smi%20join%201024*|no-warmup%20string%20join%201*|no-warmup%20string%20join%202*|no-warmup%20string%20join%204*|no-warmup%20string%20join%208*|no-warmup%20string%20join%2032*|no-warmup%20string%20join%2064*|no-warmup%20string%20join%20128*|no-warmup%20string%20join%20256*|no-warmup%20string%20join%20512*|no-warmup%20string%20join%201024*|no-warmup%20double%20join%201*|no-warmup%20double%20join%202*|no-warmup%20double%20join%204*|no-warmup%20double%20join%208*|no-warmup%20double%20join%2032*|no-warmup%20double%20join%2064*|no-warmup%20double%20join%20128*|no-warmup%20double%20join%20256*|no-warmup%20double%20join%20512*|no-warmup%20double%20join%201024*|no-warmup%20object%20join%201*|no-warmup%20object%20join%202*|no-warmup%20object%20join%204*|no-warmup%20object%20join%208*|no-warmup%20object%20join%2032*|no-warmup%20object%20join%2064*|no-warmup%20object%20join%20128*|no-warmup%20object%20join%20256*|no-warmup%20object%20join%20512*|no-warmup%20object%20join%201024*|no-warmup%20sparseSmi%20join%201*|no-warmup%20sparseSmi%20join%202*|no-warmup%20sparseSmi%20join%204*|no-warmup%20sparseSmi%20join%208*|no-warmup%20sparseSmi%20join%2032*|no-warmup%20sparseSmi%20join%2064*|no-warmup%20sparseSmi%20join%20128*|no-warmup%20sparseSmi%20join%20256*|no-warmup%20sparseSmi%20join%20512*|no-warmup%20sparseSmi%20join%201024*|no-warmup%20sparseString%20join%201*|no-warmup%20sparseString%20join%202*|no-warmup%20sparseString%20join%204*|no-warmup%20sparseString%20join%208*|no-warmup%20sparseString%20join%2032*|no-warmup%20sparseString%20join%2064*|no-warmup%20sparseString%20join%20128*|no-warmup%20sparseString%20join%20256*|no-warmup%20sparseString%20join%20512*|no-warmup%20sparseString%20join%201024*&amp;chd=t:0.2705000000000002,0.827,0.9710000000000001,1.7589999999999986,2.6610000000000014,3.1854999999999993,4.577,6.467500000000001,10.1465,17.767000000000003,0.26950000000000074,0.8610000000000007,0.984,1.8260000000000005,3.0090000000000003,3.7769999999999992,4.791,7.082000000000001,10.989,20.4125,0.285499999999999,1.2044999999999995,1.4399999999999995,2.7680000000000007,5.922000000000001,9.575000000000001,16.718,31.2075,58.522499999999994,118.75650000000002,0.34050000000000047,1.0060000000000002,1.2530000000000001,2.3870000000000005,4.8580000000000005,7.413499999999999,11.918000000000001,21.0895,39.62650000000001,79.917,0.8514999999999997,0.9604999999999997,1.7630000000000017,2.2535000000000007,3.461499999999999,4.651,7.747999999999999,11.6455,25.980000000000004,50.609,0.809000000000001,0.9265000000000008,1.7535000000000007,2.2634999999999987,3.5775000000000006,4.557,6.246499999999999,9.7475,26.759999999999998,52.8435|0.15850000000000009,0.16650000000000098,0.19899999999999984,0.23950000000000138,0.5190000000000001,0.9154999999999998,1.8260000000000005,3.2424999999999997,5.969000000000001,10.868500000000001,0.15450000000000053,0.16999999999999993,0.21550000000000047,0.2580000000000009,0.6000000000000014,1.2074999999999996,2.0070000000000014,3.5500000000000007,5.814,11.035,0.16800000000000104,0.4450000000000003,0.6749999999999989,1.0949999999999989,3.9555000000000007,7.324,13.8795,27.529500000000006,53.956,107.6,0.4580000000000002,0.35749999999999993,0.4870000000000001,0.8119999999999994,2.747,5.919499999999999,10.620500000000002,19.0885,37.894999999999996,71.85900000000001,0.17050000000000054,0.1894999999999989,0.21499999999999986,0.2829999999999995,0.6709999999999994,1.3369999999999997,2.269,3.8774999999999995,6.939000000000002,13.055499999999999,0.1634999999999991,0.1844999999999999,0.22199999999999953,0.30049999999999955,0.7420000000000009,1.4894999999999996,2.3535000000000004,3.929500000000001,7.009,13.5425,_ "Results")
